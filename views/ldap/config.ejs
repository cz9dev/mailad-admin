<!-- views/ldap/config.ejs -->
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">                
                <form action="/ldap/test-connection" method="POST" class="d-inline">
                    <button type="submit" class="btn btn-outline-info"
                        onclick="this.innerHTML='<i class=\'bi bi-arrow-repeat spinner-border spinner-border-sm\'></i> Probando...';this.disabled=true;this.form.submit();">
                        <i class="bi bi-play-circle"></i> Probar Conexión
                    </button>
                </form>
            </div>

            <div class="card">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-diagram-3"></i> Configuración Actual
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <tbody>
                                <tr>
                                    <th style="width: 200px;">URL del Servidor</th>
                                    <td>
                                        <code><%= config.url %></code>
                                        <% if (!config.url) { %>
                                            <span class="badge bg-warning ms-2">No configurado</span>
                                        <% } %>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Base DN</th>
                                    <td>
                                        <code><%= config.baseDN %></code>
                                        <% if (!config.baseDN) { %>
                                            <span class="badge bg-warning ms-2">No configurado</span>
                                        <% } %>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Bind DN</th>
                                    <td>
                                        <code><%= config.bindDN %></code>
                                        <% if (!config.bindDN) { %>
                                            <span class="badge bg-warning ms-2">No configurado</span>
                                        <% } %>
                                    </td>
                                </tr>
                                <tr>
                                    <th>Contraseña</th>
                                    <td>
                                        <% if (config.hasPassword) { %>
                                            <span class="text-success">
                                                <i class="bi bi-check-circle"></i> Configurada
                                            </span>
                                            <small class="text-muted ms-2">(••••••••)</small>
                                        <% } else { %>
                                            <span class="text-danger">
                                                <i class="bi bi-x-circle"></i> No configurada
                                            </span>
                                        <% } %>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <!-- Información del Dominio -->
            <% if (domainInfo) { %>
            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="card-title mb-0">
                        <i class="bi bi-info-circle"></i> Información del Dominio
                    </h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-sm">
                            <tbody>
                                <tr>
                                    <th style="width: 200px;">Dominio</th>
                                    <td><code><%= domainInfo.domain %></code></td>
                                </tr>
                                <tr>
                                    <th>Servidor</th>
                                    <td><code><%= domainInfo.server %></code></td>
                                </tr>
                                <tr>
                                    <th>Nivel de Funcionalidad</th>
                                    <td><code><%= domainInfo.functionality %></code></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            <% } %>

            <!-- Información -->
            <div class="card mt-4">
                <div class="card-header">
                    <h6 class="card-title mb-0">Información</h6>
                </div>
                <div class="card-body">
                    <p>Esta configuración se obtiene de las variables de entorno del sistema:</p>
                    <ul>
                        <li><code>LDAP_URL</code> - URL del servidor LDAP/AD</li>
                        <li><code>LDAP_BASE_DN</code> - DN base para búsquedas</li>
                        <li><code>LDAP_BIND_DN</code> - Usuario para autenticación</li>
                        <li><code>LDAP_BIND_PASSWORD</code> - Contraseña para autenticación</li>
                    </ul>
                    <p class="text-muted mb-0">
                        <small>
                            <i class="bi bi-shield-lock"></i> 
                            Por seguridad, la configuración LDAP/AD solo puede modificarse editando las variables de entorno del servidor.
                        </small>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>